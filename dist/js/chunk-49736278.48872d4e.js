(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-49736278"],{"1eae":function(t,e,s){},"3f6e":function(t,e,s){t.exports=s.p+"img/bg.64708479.png"},"50a0":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"TClass"},[s("el-container",[s("el-header",[s("div",{staticClass:"headerTitle"},[t._v(t._s(t.cp))])]),s("el-main",[s("el-row",{staticClass:"main"},[s("el-col",{attrs:{span:19}},[s("el-row",{staticClass:"classInfo"},[s("el-col",{staticClass:"left",attrs:{span:19}},[s("span",[t._v(t._s(t.name))]),s("span",{staticClass:"roomId"},[t._v("ID:"+t._s(t.roomId))])])],1),s("div",{staticClass:"localVideo",class:{wbColor:t.useWB,multiplePusher:t.useWB|t.useScreen|t.isStudentPushed|t.useLocalStreamListOnlyStudent.length>0}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.useWB|t.useScreen|t.isStudentPushed|t.useLocalStreamListOnlyStudent.length>0,expression:"\n                                useWB | useScreen | isStudentPushed | (useLocalStreamListOnlyStudent.length > 0)\n                            "}],staticClass:"localvideoSmall"},[s("div",[s("video",{ref:"pushVideo2",attrs:{autoplay:"",muted:""},domProps:{muted:!0}}),s("span",[t._v("老师")]),t.smallCloseText?s("div",{staticStyle:{position:"absolute",left:"0%",top:"40%",width:"100%",color:"white","font-size":"10px"}},[t._v("\n                                    等待老师连接....\n                                ")]):t._e()]),t.isStudentPushed?s("div",[s("video",{ref:"pushtStudentVideo",attrs:{autoplay:"",muted:""},domProps:{muted:!0}}),s("span",[t._v("我")])]):t._e(),t._l(t.useLocalStreamListOnlyStudent,function(e){return s("div",{key:e.stream_id},[s("video",{ref:e.stream_id,refInFor:!0,attrs:{autoplay:"",muted:""},domProps:{muted:!0}}),s("p",{directives:[{name:"show",rawName:"v-show",value:e.extra_info&&!e.extra_info.video,expression:"student.extra_info && !student.extra_info.video"}],class:[e.extra_info.audio?"onlyAudio":"noAudioVideo"]}),s("span",{directives:[{name:"show",rawName:"v-show",value:e.extra_info&&e.extra_info.video&&!e.extra_info.audio,expression:"\n                                        student.extra_info && student.extra_info.video && !student.extra_info.audio\n                                    "}]},[t._v("麦克风未打开")])])})],2),s("video",{directives:[{name:"show",rawName:"v-show",value:!t.useWB|t.useScreen,expression:"!useWB | useScreen"}],ref:"pushVideo",attrs:{autoplay:"",muted:""},domProps:{muted:!0}}),s("div",{directives:[{name:"show",rawName:"v-show",value:t.useWB,expression:"useWB"}],ref:"pushDIV",class:{wbBColor:t.useWB}}),t.closeText?s("span",{staticStyle:{position:"absolute",left:"0%",top:"50%",width:"100%","text-align":"center",color:"white"}},[t._v("等待老师连接....")]):t._e(),s("span",{directives:[{name:"show",rawName:"v-show",value:!t.useWB&&!t.useScreen&&(t.useLocalStreamListOnlyStudent.length>0||t.isStudentPushed),expression:"\n                                !useWB &&\n                                    !useScreen &&\n                                    (useLocalStreamListOnlyStudent.length > 0 || isStudentPushed)\n                            "}],staticClass:"cameraContain"},[s("span",{staticClass:"noShare"}),s("span",{staticClass:"noShareText"},[t._v("暂无分享内容")])])]),s("el-row",{staticClass:"handlerSection"},[s("el-col",{staticClass:"mediaSwitch",attrs:{span:18,lg:16}},[s("el-tooltip",{attrs:{effect:"dark",content:t.isStudentPushed?"下讲台":"上讲台",placement:"top-start"}},[s("el-button",{class:{openPush:!t.isStudentPushed,closePush:t.isStudentPushed},attrs:{type:"text"},on:{click:t.togglePushStudent}})],1),s("el-button",{class:{openAudio:t.audioOpen,closeAudio:!t.audioOpen},attrs:{type:"text"},on:{click:function(e){return t.toggleAudio(!1)}}}),s("el-button",{directives:[{name:"show",rawName:"v-show",value:t.isStudentPushed,expression:"isStudentPushed"}],class:{stOpenVideo:t.stPushVideoOpen,stCloseVideo:!t.stPushVideoOpen},attrs:{type:"text"},on:{click:t.toggleStVideo}}),s("el-button",{directives:[{name:"show",rawName:"v-show",value:t.isStudentPushed,expression:"isStudentPushed"}],class:{stOpenAudio:t.stPushAudioOpen,stCloseAudio:!t.stPushAudioOpen},attrs:{type:"text"},on:{click:t.toggleStAudio}})],1)],1)],1),s("el-col",{attrs:{span:5}},[s("div",{staticClass:"chatHeader"},[s("span",[t._v("讨论区 （人数: "+t._s(t.userList.length)+" 人）")])]),s("div",{class:{chatBody:!0,addWB:!1}},[s("ul",t._l(t.chatList,function(e,i){return s("li",{key:i,class:{me:e.id_name===t.idName,teacher:t.hostIdName===e.id_name}},[e.id_name!==t.idName?s("div",{staticClass:"userName"},[s("span",[t._v(t._s(t.hostIdName!==e.id_name?"学生":"老师"))]),s("span",{directives:[{name:"show",rawName:"v-show",value:t.hostIdName!==e.id_name,expression:"hostIdName !== chat.id_name"}]},[t._v("\n                                        "+t._s(e.id_name.substr(e.id_name.length-6))+"\n                                    ")])]):t._e(),s("div",{staticClass:"userContent"},[t._v(t._s(e.msg_content))])])}),0)]),s("div",{staticClass:"chatFooter"},[s("el-input",{attrs:{placeholder:"输入消息参与互动"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.sendMsg(e)}},model:{value:t.inputMsg,callback:function(e){t.inputMsg=e},expression:"inputMsg"}}),s("el-button",{attrs:{disabled:2!==t.liveStatus||!t.inputMsg||t.allBan},on:{click:t.sendMsg}},[t._v("发送\n                        ")])],1)])],1)],1)],1)],1)},a=[],o=s("9ab4"),n=s("60a3"),u=s("050b"),r=s("4bb5"),d=s("c4e7"),l=s("0613"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ruleForm={password:""},e.logo=s("5684"),e.bg=s("3f6e"),e.roomId="",e.cp="即构课堂",e.name="即构大班直播课堂",e.userId="",e.appId="",e.liveStatus=1,e.inputMsg="",e.idName=u["a"].idName,e.useWB=!1,e.useScreen=!1,e.closeText=!1,e.smallCloseText=!1,e.allBan=!1,e.audioOpen=!1,e.isLastOne=!1,e.videoOpen=!1,e.stPushVideoOpen=!0,e.stPushAudioOpen=!0,e.useLocalStreamList=[],e.isStudentPushed=!1,e.studentPushStreamId="student"+(new Date).getTime(),e}return o["d"](e,t),e.prototype.watchBoolean=function(t){this.videoOpen=t,1==t?!this.useWB&&!this.useScreen&&this.useLocalStreamListOnlyStudent.length<1&&!this.isStudentPushed?this.closeText=t:this.smallCloseText=t:(this.closeText=t,this.smallCloseText=t)},e.prototype.watchAllBanBoolean=function(t){1==t?(this.allBan=!0,this.$notify({title:"警告",message:"老师已全员禁言",type:"warning"})):this.allBan=!1},Object.defineProperty(e.prototype,"useLocalStreamListOnlyStudent",{get:function(){return this.useLocalStreamList.filter(function(t){return t.stream_id.startsWith("student")})},enumerable:!0,configurable:!0}),e.prototype.mounted=function(){this.roomId=this.$route.params.roomId,this.cp=this.$route.query.cp,this.name=this.$route.query.name,this.appId=this.$route.query.appId,this.userId=this.$route.query.userId,this.startLive(),u["a"].play=this.play,u["a"].stopPlay=this.stopPlay,u["a"].onRecvEndJoinLiveCommand=this.onRecvEndJoinLiveCommand,u["a"].onStreamExtraInfoUpdated=this.onStreamExtraInfoUpdated},e.prototype.beforeDestroy=function(){u["a"].play=function(){},u["a"].stopPlay=function(){},u["a"].onRecvEndJoinLiveCommand=function(){},u["a"].onStreamExtraInfoUpdated=function(){}},e.prototype.startLive=function(){var t=this,e=Number(this.appId);u["a"].login(this.roomId,2,e,this.userId).then(function(e){t.liveStatus=2,0===e.length?t.logOut():(e.forEach(function(e){t.play(e)}),t.setStartStatus(1))},function(e){console.error(e),t.$message({message:"开启直播服务失败了！！网络正常连接下，再刷新页面重试一下吧",type:"warning"})})},e.prototype.play=function(t){var e=this,s=!1;1===this.useLocalStreamList.length&&this.useLocalStreamList[0].stream_id.startsWith("stream")&&(s=!0),t.extra_info&&"string"===typeof t.extra_info&&(t.extra_info=JSON.parse(t.extra_info)),this.useLocalStreamList.filter(function(t){return t.stream_id.startsWith("student")}).length<3&&this.useLocalStreamList.push(t);var i=t.extra_info;return t.stream_id.startsWith("screen")?(this.useWB=!1,this.useScreen=!0,u["a"].pull(this.$refs.pushVideo,t.stream_id),void(s&&(u["a"].replay(this.$refs.pushVideo2,this.useLocalStreamList[0].stream_id),setTimeout(function(){e.$refs.pushVideo2.play(),e.$refs.pushVideo.play()},500)))):t.stream_id.startsWith("student")?(this.$nextTick(function(){e.$refs[t.stream_id]&&e.$refs[t.stream_id][0]?u["a"].pull(e.$refs[t.stream_id][0],t.stream_id):setTimeout(function(){u["a"].pull(e.$refs[t.stream_id][0],t.stream_id)},1e3),e.toggleAudio(!0)}),void(s&&(u["a"].replay(this.$refs.pushVideo2,this.useLocalStreamList[0].stream_id),setTimeout(function(){e.$refs.pushVideo2.play()},500)))):(this.useWB=1===i.withWB,this.useScreen=1===i.withScreen,l["a"].commit(d["c"],i.cameraStatus),l["a"].commit(d["b"],i.studentBan),this.useScreen&&(this.useWB=!1),this.useWB?(this.targetVideo=this.$refs.pushVideo2,!u["a"].room&&this.$nextTick(function(){u["a"].joinWB(e.$refs.pushDIV,i.WBJson,!1,!0),e.videoOpen&&(e.smallCloseText=!0,e.closeText=!1)})):1===i.withScreen||this.useLocalStreamListOnlyStudent.length>0||this.isStudentPushed?(this.targetVideo=this.$refs.pushVideo2,this.videoOpen&&(this.smallCloseText=!0,this.closeText=!1)):(this.targetVideo=this.$refs.pushVideo,this.videoOpen&&(this.smallCloseText=!1,this.closeText=!0)),u["a"].pull(this.targetVideo,t.stream_id),this.isLastOne=!1,void(this.hostIdName=t.anchor_id_name))},e.prototype.togglePushStudent=function(){var t=this;if(this.useLocalStreamListOnlyStudent.length>=3)this.$notify({title:"警告",message:"讲台人数已经超过3人，不能再上讲台",type:"warning"});else if(this.useLocalStreamList.some(function(t){return t.stream_id.startsWith("stream")})){if(this.isStudentPushed=!this.isStudentPushed,this.isStudentPushed)this.$nextTick(function(){if(1===t.useLocalStreamList.length){var e=t.useLocalStreamList.find(function(t){return t.stream_id.startsWith("stream")});e&&u["a"].replay(t.$refs.pushVideo2,e.stream_id),t.$refs.pushVideo2.muted=!t.audioOpen}u["a"].preview(t.$refs.pushtStudentVideo,t.studentPushStreamId,{withWB:0,withScreen:0,WBJson:"",audio:!0,video:!0})});else if(u["a"].stopPreview(this.$refs.pushtStudentVideo),u["a"].stopPublish(this.studentPushStreamId),1===this.useLocalStreamList.length&&!this.useScreen&&!this.useWB){var e=this.useLocalStreamList.find(function(t){return t.stream_id.startsWith("stream")});e&&u["a"].replay(this.$refs.pushVideo,e.stream_id),this.$refs.pushVideo.muted=!this.audioOpen,setTimeout(function(){t.$refs.pushVideo.play()},500)}}else this.$notify({title:"警告",message:"老师暂时离开，此时不能上讲台",type:"warning"})},e.prototype.toggleAudio=function(t){var e=this;void 0===t&&(t=!1),t||(this.audioOpen=!this.audioOpen),this.useLocalStreamListOnlyStudent.forEach(function(t){e.$refs[t.stream_id]&&e.$refs[t.stream_id][0]&&(e.$refs[t.stream_id][0].muted=!e.audioOpen)}),this.$refs.pushVideo2.muted=!this.audioOpen,this.$refs.pushVideo.muted=!this.audioOpen},e.prototype.stopPlay=function(t,e){var s=this,i=this.useLocalStreamList.findIndex(function(e){return e.stream_id===t.stream_id});this.useLocalStreamList.splice(i,1),1!==this.useLocalStreamList.length||!this.useLocalStreamList[0].stream_id.startsWith("stream")||this.isStudentPushed||this.useWB||this.useScreen||this.$nextTick(function(){u["a"].replay(s.$refs.pushVideo,s.useLocalStreamList[0].stream_id)}),t.stream_id.startsWith("screen")&&(this.useScreen=!1),this.isLastOne=e,console.log("stopPlay",t),this.isLastOne&&setTimeout(function(){s.isLastOne&&s.logOut()},1e4)},e.prototype.sendMsg=function(){!this.isAllBan&&this.inputMsg&&(u["a"].sendRoomMsg(this.inputMsg,this.idName),this.setChatInfo([{id_name:this.idName,nick_name:this.idName,role:1,msg_id:"0",msg_category:1,msg_type:1,msg_content:this.inputMsg,send_time:(new Date).getTime()}]),this.inputMsg="",this.$nextTick(function(){document.querySelector(".chatBody").scrollTop=document.querySelector(".chatBody ul li:last-child").offsetTop}))},e.prototype.logOut=function(){this.setStartStatus(2),u["a"].leaveRoom(),u["a"].stopWB(),this.$router.push(this.$route.fullPath.replace("pull","student"))},e.prototype.onRecvEndJoinLiveCommand=function(t,e,s,i){this.isStudentPushed&&this.togglePushStudent()},e.prototype.toggleStVideo=function(){this.stPushVideoOpen=!this.stPushVideoOpen,u["a"].toggleVideo(this.stPushVideoOpen),u["a"].updateStreamExtraInfo(this.studentPushStreamId,JSON.stringify({audio:this.stPushAudioOpen,video:this.stPushVideoOpen}))},e.prototype.toggleStAudio=function(){this.stPushAudioOpen=!this.stPushAudioOpen,u["a"].toggleAudio(this.stPushAudioOpen),u["a"].updateStreamExtraInfo(this.studentPushStreamId,JSON.stringify({audio:this.stPushAudioOpen,video:this.stPushVideoOpen}))},e.prototype.onStreamExtraInfoUpdated=function(t){var e=this;this.useLocalStreamList=this.useLocalStreamList.map(function(e){return t.forEach(function(t){e.stream_id===t.stream_id&&(e.extra_info=JSON.parse(t.extra_info))}),e}),t.forEach(function(t){if(t.stream_id.startsWith("stream")){var s=JSON.parse(t.extra_info);"number"===typeof s.withWB&&(0===s.withWB?e.useWB=!1:1===s.withWB&&(e.useWB=!0,!u["a"].room&&e.$nextTick(function(){u["a"].joinWB(e.$refs.pushDIV,s.WBJson,!1,!0),e.videoOpen&&(e.smallCloseText=!0,e.closeText=!1)})),1===e.useLocalStreamList.length&&e.useLocalStreamList[0].stream_id.startsWith("stream")&&!e.isStudentPushed&&u["a"].replay(e.useWB?e.$refs.pushVideo2:e.$refs.pushVideo,e.useLocalStreamList[0].stream_id)),0===s.withScreen&&(e.useScreen=!1)}})},o["c"]([Object(r["b"])("userList")],e.prototype,"userList",void 0),o["c"]([Object(r["b"])("cameraStatus")],e.prototype,"cameraStatus",void 0),o["c"]([Object(r["b"])("isAllBan")],e.prototype,"isAllBan",void 0),o["c"]([Object(r["b"])("chatList")],e.prototype,"chatList",void 0),o["c"]([Object(r["a"])(d["d"])],e.prototype,"setChatInfo",void 0),o["c"]([Object(r["a"])(d["f"])],e.prototype,"setStartStatus",void 0),o["c"]([Object(n["e"])("cameraStatus")],e.prototype,"watchBoolean",null),o["c"]([Object(n["e"])("isAllBan")],e.prototype,"watchAllBanBoolean",null),e=o["c"]([Object(n["a"])({})],e),e}(n["d"]),c=h,p=c,m=(s("b901"),s("2877")),f=Object(m["a"])(p,i,a,!1,null,null,null);e["default"]=f.exports},5684:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAAAZCAYAAAC1ken9AAAHbUlEQVRoQ92Ze4xcVR3HP797p2wfUEtpLLA7FQkR2gprWrSltnbnbqliQNRQUSHKO0GBaAyPACpKFARrwFAoGouKIA2JaAkiQmempVBXqQ9UiEha6M5CoVVsS3W63Ht+5szz3rvzuNPdJejvv5n7e53vOed3fg/h/4bUwWMhsAQ4DpgGvAHsAp7G8Bh5eb6j5Z6sRxKwHOgFeoAulD0Iz2PYxF42sEWsjaYkKad7JTgf7MhwQ2Z9yDeFK6ufUk76euBjo9Xrm+JC2Pl6Uz0n6SQmcinC54FZLewpypPAN8nJL1v6ldH3A9ciJXCdFrx281ZjWEle/tWIT1w3vVbgE6MFQtG7g6Dwmaoe103/QOC80er1g9enwWu7G+pZposx/Ag4uiM7yi9QLiAvFqA69enBOHwX5RwE6UDnK8CFZOXBuMwYAsyaIBg8/00DuE/Px2E1kOoAiDqr8gLwIXLyt9qfnm6shJgDUWmAa8jKjWHhsQNYuSMwg597UwDu0zNxuLfJ9d0H/BYYAiYCxwJzm/AOsZ9FPCHbS357egHw/Qi6NrAIf0F5FmE/MBOYDxzWZBcuJyvfrn4TmDkFug5KumWua24SxDpSI1XdFRgzD14abAawKlsD4yxOaqfO9+IOQGu/+/UElIEKeOETuQ3l60zipzwsFog6edoNfAG4tPRQRZznKfawqPxYqeDxFDAPsCfyTnxuZqNsi8isUJddnIpg35njY2sKgOVkJWv/7yTO4LrdKwRnbVRODSIf9v3BR8KGRsRg1ed8U7CnaRSkQobNCAtiSn6G4bPkpfljaAX69D0I6xDSMfmryMq3Sv9l9OMI38O+SxWQmjo8XycwlVsQaje3wruVLubYje4A4CNmu647IMgh0RNgrvfN0FfiTowLwEv1NFzWxU7gr5jBqdwv9uS0p349unIDZoSYd7OPWQzIHvo0hWE2G+XP7ZVVODy1G3JhhN9wCXlZlRDgGYeknEkDCLOjRnW9HxRsKmOvU4TGBWBPbXp1Ss2QspMix7FZ/pkYjPIpPR3hGzGZL5OVBzrSU2U+RruYxR8ggs+zZGVOIoBdt+d+Qc4IG1dlKDDD8+CVVxs5NeYAL9CpTGYXwoQQwFeTkxsOCJSxFio/vPdF1Apz2wLsOOkvOULtVSwrUJ9APJ/Bx5v5GQdYlW2BkWXJ17X9RaB+7ft1GcqjIXAVn24el5eT6xxHzlO0iyI7EcIh9KKWAKfoWYrLYyCRXNOoXmFM4eZW7o620PCD4ZmR2+HpxcDtIYC3kZPOCoxxxLekOqN5hKU1M8INLQBOH+k6bBHh8EhogHVBMPjRSOrUwPFxAPhaKKVFlUvEE+Skfdrn6X9GpHTNgPY5oaPHLa4no/cgfDrk4+3NAJ6QctM5wNbkdf5SLuvOhxca1t1h3jEHOKOXI9wUcn6AnNjmTmvqBOCARWyQze1UNv2e0bVIpO1wR0OAU07PrYhcFlNU9AN/Mby8JYkDIwFWX5GGD2IjfUEQ9MJL9V6Bp+cCa0IA7yQnb2/rSycAG84mL/e01dmMwVNbQb639tlw3QiAXTf9KQFrJPLNqLnYmCFb+yeiMc8i+nQhDtHTJfSyXp5u6ZCnvwdGVqpKN1JqaYauKHeRkwNrUJ2k05nIjliWc2YM4PS7XVd/I8iUqF29NwgKZyVCtsI05gDbqultpd7u1NApXkVOLunErxLvHD2Iw/n7iPamspciR3WcV1ud8RBmawNDdwjg6VNTzuTfIfKu2K4+45vigpY92QYrHHOArQ1PbYiwoaJKw/ic2PHDlNGrGxQaVZ2ryYrNWJLTEj2CFH9FODQklCUr/TWAXTf9gIDNDkIHRPcFgf8+2PFMcmtlznEBOKO9CPbKh5vgz1FkCU8mjO+e2srT9m2bNbgUw3nk5YeJ1rxcp+Dza2BRjP8jtj9cAthxeq50JNrHtP8renYQFA4o6I8LwOVTfBdwTmwxdoSzgrz8sSUo5R7ybQ06cbYlGQ6XtsD5KlluhBY9jj49ptI2rT9sZQc2kpVSPiypVLeHyiPxYgLVP6lovF5v4b/zRhAM/rzK0KCS24GYKxKdihBTEAzZ8rM+91qshzKBLQjvjOnygbsxrGEvA7VZWZ9Ow+FklMsQRubNyo8RbJv1mhG+aakPfAvDPFi/IerwAXpJcW5pKiJMisntZph5bJKtJYBdp2e7iMTbd53iYBu2u4NgsPYqjzYPrjrQcGSU0bkIdvowvYmjwyivIkyuDD8bz9WUTRRZzmb242HbsJF+S0z3P1D+DcxoAGqVdT8Bp7FBaiW9pNy0FYrvwlsbYOvdMj0eU4ql7+jY2XL8ewjlk7Uecrm3eycSeUSTq1ZeA1aQk/Vhof9dgO0q+vWw0hVWzko8pLSpmMPXWM93QOqTkioqGbWD25UI4X5xO6AfxXARebFzvghJykmvBHXbaUjwveibwlX1GNx9hqicmECuJYtvCtcBxZZMGbUzsi8inA4c3ITXLv4nGFaRFzuGak62NToFm6rZoiOattal7FjqYZTb4qc2rPi/85rpaa532UYAAAAASUVORK5CYII="},b901:function(t,e,s){"use strict";var i=s("1eae"),a=s.n(i);a.a}}]);
//# sourceMappingURL=chunk-49736278.48872d4e.js.map