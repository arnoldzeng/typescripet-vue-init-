{"version":3,"sources":["webpack:///./src/service/room.ts","webpack:///./src/views/studentPhone/index.vue?439b","webpack:///./src/views/studentPhone/index.vue","webpack:///./src/views/studentPhone/index.vue?a4a9","webpack:///./src/views/studentPhone/index.vue?557c","webpack:///./src/views/studentPhone/index.vue?fec2"],"names":["_api__WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","Room","classCreate","room_key","room_name","user_id","start_time","anchor_name","post","classRoomlist","get","params","classModify","room_id","classTitle","title","classRoom","classDelete","appAdd","app_id","app_sign","appModify","flowLimit","render","_vm","this","_h","$createElement","_c","_self","ref","staticClass","class","blackBg","gotoSafari","bg","endLive","liveEnd","_v","_s","status","name","startTime","_m","staticRenderFns","studentPhonevue_type_script_lang_ts_Index","_super","Index","_this","apply","arguments","cp","roomId","appId","userId","supportCheck","tslib_es6","prototype","mounted","jZego_rtc","supportDetection","result","console","warn","webRtc","videoDecodeType","VP8","info","push","$message","warning","join","isWeChat","navigator","userAgent","includes","isIos","test","$route","query","router","$router","time","checkRoomExist","log","room","then","res","msg","code","exist","Number","webrtcService","login","list","length","setTimeout","fullPath","replace","err","error","Object","lib","mutations","vue_property_decorator","studentPhonevue_type_script_lang_ts_","views_studentPhonevue_type_script_lang_ts_","component","componentNormalizer","__webpack_exports__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_10_oneOf_1_0_node_modules_css_loader_index_js_ref_10_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_10_oneOf_1_2_node_modules_less_loader_dist_cjs_js_ref_10_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_lang_less___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_10_oneOf_1_0_node_modules_css_loader_index_js_ref_10_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_10_oneOf_1_2_node_modules_less_loader_dist_cjs_js_ref_10_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_lang_less___WEBPACK_IMPORTED_MODULE_0___default","n"],"mappings":"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","file":"js/chunk-4dc9fffc.4600c373.js","sourcesContent":["import {\n    classRoomlist,\n    classCreate,\n    classModify,\n    classDelete,\n    classTitle,\n    classRoom,\n    appAdd,\n    appModify,\n    flowLimit,\n    fetch,\n} from './api';\n\nexport default class Room {\n    public static classCreate(\n        room_key: string,\n        room_name: string,\n        user_id: string,\n        start_time: string,\n        anchor_name: string,\n    ): Promise<any> {\n        return fetch.post(classCreate, {\n            room_name,\n            room_key,\n            user_id,\n            start_time,\n            anchor_name,\n        });\n    }\n\n    public static classRoomlist(user_id: string): Promise<any> {\n        return fetch.get(classRoomlist, {\n            params: { user_id },\n        });\n    }\n\n    public static classModify(\n        room_key: string,\n        room_name: string,\n        user_id: string,\n        start_time: string,\n        anchor_name: string,\n        room_id: string,\n    ): Promise<any> {\n        return fetch.post(classModify, {\n            room_name,\n            room_key,\n            user_id,\n            start_time,\n            anchor_name,\n            room_id,\n        });\n    }\n\n    public static classTitle(user_id: string, title: string): Promise<any> {\n        return fetch.post(classTitle, {\n            user_id,\n            title,\n        });\n    }\n\n    public static classRoom(room_id: string): Promise<any> {\n        return fetch.get(classRoom, {\n            params: { room_id },\n        });\n    }\n\n    public static classDelete(room_id: string, user_id: string): Promise<any> {\n        return fetch.post(classDelete, {\n            room_id,\n            user_id,\n        });\n    }\n\n    public static appAdd(user_id: string, app_id: number, app_sign: string): Promise<any> {\n        return fetch.post(appAdd, {\n            app_id,\n            user_id,\n            app_sign,\n        });\n    }\n\n    public static appModify(user_id: string, app_id: number, app_sign: string): Promise<any> {\n        return fetch.post(appModify, {\n            app_id,\n            user_id,\n            app_sign,\n        });\n    }\n\n    // 流量查询\n    public static flowLimit(user_id: string, app_id: number): Promise<any> {\n        return fetch.post(flowLimit, {\n            app_id,\n            user_id,\n        });\n    }\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"studentPhone\",staticClass:\"studentPhone\",class:{ blackBg: _vm.gotoSafari }},[(!_vm.gotoSafari)?[_c('div',{staticClass:\"main\"},[_c('div',{class:{ bg: true, endLive: _vm.liveEnd }}),_c('div',{staticClass:\"point\"},[_vm._v(_vm._s(_vm.status))]),_c('div',{staticClass:\"title\"},[_vm._v(_vm._s(_vm.name))]),_c('div',{staticClass:\"playTime\"},[_vm._v(\"预计开始时间：\"+_vm._s(_vm.startTime))])]),_vm._m(0)]:_c('div',{staticClass:\"openInSafari\"})],2)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"footer\"},[_c('div',{staticClass:\"footerText\"})])}]\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Prop } from 'vue-property-decorator';\nimport { VueRouter } from 'vue-router/types/router';\nimport { Mutation, State } from 'vuex-class';\nimport { setLoginStatus } from '@/store/mutations';\nimport Room from '@/service/room';\nimport webrtcService from '@/service/webrtcService';\nimport { ChatInfo, StreamInfo } from 'webrtc-zego/sdk/common/zego.entity';\nimport { ZegoClient } from 'webrtc-zego';\n\n@Component({})\nexport default class Index extends Vue {\n    router!: VueRouter;\n    liveEnd: boolean = false;\n    startTime = '';\n    name = 'AE + C4D 栏目包装 影视特效 平面电商零基础职业化培训课程';\n    cp = '';\n    roomId: string = '';\n    status = '直播还未开始，请稍后';\n    appId = '';\n    userId = '';\n    @State('isStart')\n    isStart!: 0 | 1 | 2;\n    @Mutation(setLoginStatus)\n    setLoginStatus!: (login: boolean) => void;\n    supportCheck = true;\n    gotoSafari = false;\n\n    mounted() {\n        ZegoClient.supportDetection(\n            (result: {\n                capture: boolean;\n                screenSharing: boolean;\n                webRtc: boolean;\n                videoDecodeType: {\n                    VP8: boolean;\n                };\n            }) => {\n                console.warn('supportDetection', result);\n                if (!result.webRtc || !result.videoDecodeType.VP8) {\n                    let info = ['当前浏览器不支持:'];\n                    !result.webRtc && info.push('webrtc,');\n                    !result.videoDecodeType.VP8 && info.push('vp8视频编码,');\n                    info.push('建议使用chrome72+,safari12.3+打开该页面');\n                    this.$message.warning(info.join());\n                    this.supportCheck = false;\n                }\n            },\n            () => {\n                this.$message.warning('建议使用chrome72+,safari12.3+打开该页面');\n                this.supportCheck = false;\n            },\n        );\n\n        const isWeChat = navigator.userAgent.includes('MicroMessenger'); //取得浏览器的userAgent字符串\n        const isIos = /(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent);\n        if (isWeChat && isIos && this.$route.query.appId !== '2172413822') {\n            this.gotoSafari = true;\n        } else {\n            this.router = this.$router as VueRouter;\n            this.cp = this.$route.query.cp as string;\n            this.name = this.$route.query.name as string;\n            this.startTime = this.$route.query.time as string;\n            this.appId = this.$route.query.appId as string;\n            this.userId = this.$route.query.userId as string;\n            this.roomId = this.$route.params.roomId;\n            this.supportCheck && this.checkRoomExist();\n        }\n    }\n\n    checkRoomExist() {\n        console.log(this.$router);\n        Room.classRoom(this.roomId).then(res => {\n            if (res.msg.code === 200) {\n                console.log('checkRoomExist', this.$router);\n                if (res.exist) {\n                    let appId = Number(this.appId);\n                    webrtcService.login(this.roomId, 2, appId, this.userId, true).then(\n                        (list: StreamInfo[]) => {\n                            // 主播未开始\n                            if (list.length === 0) {\n                                // this.logOut();\n                                setTimeout(() => {\n                                    this.checkRoomExist();\n                                }, 5000);\n                            } else {\n                                this.$router.push(this.$route.fullPath.replace('student', 'pull'));\n                            }\n                        },\n                        err => {\n                            console.error(err);\n                        },\n                    );\n                }\n            } else {\n                this.liveEnd = true;\n                this.status = '直播已经结束';\n            }\n        });\n    }\n\n    // beforeRouteEnter(to: any, from: any, next: any): void {\n    //     // if (from.path.indexOf('pull') == 1) {\n    //     //     next((vm: any) => {\n    //     //         vm.status = '直播已经结束';\n    //     //     });\n    //     // }\n    //     // next();\n    //\n    //     if (this && this.appId) {\n    //         this.checkRoomExist();\n    //     } else {\n    //         next();\n    //     }\n    // }\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--13-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--13-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=60f1bf39&\"\nimport script from \"./index.vue?vue&type=script&lang=ts&\"\nexport * from \"./index.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=less&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=less&\""],"sourceRoot":""}